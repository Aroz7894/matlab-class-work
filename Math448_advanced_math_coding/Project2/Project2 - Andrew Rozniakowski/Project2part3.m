%Project Part 3
clear all
close all

A = [0 0 1 0 1 0; 1 0 1 0 0 1; 1 1 0 1 1 0; 0 0 1 0 1 0; 1 0 0 1 0 0; 0 1 0 0 0 0]; 
s = sum(A);
M1 = A(1:6)/s(1);
M2 = A(7:12)/s(2);
M3 = A(13:18)/s(3);
M4 = A(19:24)/s(4);
M5 = A(25:30)/s(5);
M6 = A(31:36)/s(6);
M = transpose([M1;M2;M3;M4;M5;M6]);

%Part b
x = [50000; 200000; 300000; 225000; 125000; 100000];
Mx = M*x;
x0 = x/1000000;

%Part C
fprintf('Part C of question 3\n');
Project2part3c(M, x0, 100); 

%Part D
fprintf('Part D of question 3: Testing 10 by 10 matrix\n');
%Creating and testing 10x10 matrix
A_d = [0 0 1 1 0 0 1 1 0 1; 1 0 0 0 0 0 1 0 0 1; 1 0 0 0 0 0 0 1 0 1;0 1 0 1 0 1 0 0 1 1; 1 0 0 0 1 0 1 0 1 0; 1 0 1 0 0 1 0 0 1 0; 1 0 0 0 0 0 0 0 0 0; 0 0 1 0 1 0 1 0 0 1; 1 1 0 0 0 0 0 0 0 0; 0 0 0 0 0 0 1 0 0 0]; 
s_d = sum(A_d);
M1_d = A_d(1:10)/s_d(1);
M2_d = A_d(11:20)/s_d(2);
M3_d = A_d(21:30)/s_d(3);
M4_d = A_d(31:40)/s_d(4);
M5_d = A_d(41:50)/s_d(5);
M6_d = A_d(51:60)/s_d(6);
M7_d = A_d(61:70)/s_d(7);
M8_d = A_d(71:80)/s_d(8);
M9_d = A_d(81:90)/s_d(9);
M10_d = A_d(91:100)/s_d(10);

M_d = transpose([M1_d;M2_d;M3_d;M4_d;M5_d;M6_d; M7_d;M8_d;M9_d;M10_d]);
x_1 = [.7; .384; .541; .096; .983; .453; .4; .754; .125; .336];
Project2part3c(M_d, x_1, 200); 

%Creating 20x20 matrix and testing it
fprintf('Part D of question 3:testing 20 by 20 matrix\n');
x_2 = [.792; .333; .781; .673; .083; .463; .123; .754; .056; .136; .492; .284; .548; .396; .983; .111; .534; .002; .891; .336];
A_d2 = [0 0 1 1 0 0 1 1 0 1 0 0 1 1 0 0 1 1 0 1;0 0 1 1 0 0 1 1 0 1 1 0 0 0 0 0 1 0 0 1; 1 0 0 0 0 0 0 1 0 1 1 0 0 0 0 0 0 1 0 1;0 1 0 1 0 1 0 0 0 0 0 0 1 0 1 1 0 0 1 1; 1 1 0 0 0 0 0 0 1 0 1 0 0 0 1 0 1 0 1 0; 1 1 0 0 0 0 0 0 1 0 1 0 1 0 0 1 0 0 1 0; 1 0 0 0 0 0 0 1 0 0 0 0 0 0 1 0 1 0 0 0; 0 0 1 0 1 0 1 0 1 0 0 0 0 0 0 1 0 1 0 1; 1 1 0 1 0 0 0 0 0 0 1 0 1 0 0 0 0 0 0 0; 1 0 0 0 0 0 0 1 0 1 0 0 0 0 0 0 1 0 0 0; 1 0 0 1 1 0 0 1 0 1 0 0 1 0 0 0 1 0 0 0;1 0 1 0 0 0 0 1 0 1 0 0 0 0 0 0 1 0 0 1; 0 1 0 1 0 0 0 0 1 0 0 1 0 0 0 0 1 0 0 0; 1 1 0 0 0 0 0 0 0 1 0 0 1 0 1 0 0 0 1 0; 0 0 1 0 1 0 1 0 0 1 0 1 0 0 0 0 1 0 0 0; 0 0 0 1 0 1 0 0 0 0 0 1 1 0 0 0 0 0 0 0; 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 1 0 1; 1 0 0 0 0 0 0 1 0 1 0 0 0 1 0 0 1 0 0 0; 0 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0; 1 0 0 0 1 0 0 0 0 1 0 0 0 0 0 0 0 1 0 0]; 
s_d2 = sum(A_d2);
M1_d2 = A_d2(1:20)/s_d2(1);
M2_d2 = A_d2(21:40)/s_d2(2);
M3_d2 = A_d2(41:60)/s_d2(3);
M4_d2 = A_d2(61:80)/s_d2(4);
M5_d2 = A_d2(81:100)/s_d2(5);
M6_d2 = A_d2(101:120)/s_d2(6);
M7_d2 = A_d2(121:140)/s_d2(7);
M8_d2 = A_d2(141:160)/s_d2(8);
M9_d2 = A_d2(161:180)/s_d2(9);
M10_d2 = A_d2(181:200)/s_d2(10);
M11_d2 = A_d2(201:220)/s_d2(11);
M12_d2 = A_d2(221:240)/s_d2(12);
M13_d2 = A_d2(241:260)/s_d2(13);
M14_d2 = A_d2(261:280)/s_d2(14);
M15_d2 = A_d2(281:300)/s_d2(15);
M16_d2 = A_d2(301:320)/s_d2(16);
M17_d2 = A_d2(321:340)/s_d2(17);
M18_d2 = A_d2(341:360)/s_d2(18);
M19_d2 = A_d2(361:380)/s_d2(19);
M20_d2 = A_d2(381:400)/s_d2(20);
M_d2 = transpose([M1_d2;M2_d2;M3_d2;M4_d2;M5_d2;M6_d2; M7_d2;M8_d2;M9_d2;M10_d2; M11_d2;M12_d2;M13_d2;M14_d2;M15_d2;M16_d2; M17_d2;M18_d2;M19_d2;M20_d2]);
Project2part3c(M_d2, x_2, 200);

%Part G, compare fixed point iteration with built in linear algebra
%packages
[V,D] = eig(M_d);   %eigenvalues for M_2
[V_2,D_2] = eig(M_d2);  %eigenvalues for M_2d
